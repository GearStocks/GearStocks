version: 2.1
jobs:
  dev:
    docker:
      - image: cimg/base:2020.01
    steps:
      - checkout
      - setup_remote_docker
      - run: echo Test the pull request on dev.
      - run: echo MONGO_INITDB_ROOT_USERNAME=mongoadmin\nMONGO_INITDB_ROOT_PASSWORD=mongoadmin > database/secrets.env
      - run: docker-compose up front api_builder
      - run: echo Front and Back successfully build.

  master:
    docker:
      - image: cimg/base:2020.01
    steps:
      - checkout
      - setup_remote_docker
      - run: echo Test the pull request on master.
      - run: echo MONGO_INITDB_ROOT_USERNAME=mongoadmin\nMONGO_INITDB_ROOT_PASSWORD=mongoadmin > database/secrets.env
      - run: docker-compose up front api_builder
      - run: echo Front and Back successfully build.

      
workflows:
  version: 2
  workflow:
    jobs:
      - dev:
        filters:
          branches:
            only:
              - dev
      - master:
        filters:
          branches:
            only:
              - master